rawdata<- read.delim("miRNA_raw_counts_CORRECT_NAMES.txt", header= TRUE, row.names= 1)
rawdata<- rawdata[c(31:42)]
View(rawdata)
rawdata<- read.delim("miRNA_raw_counts_CORRECT_NAMES.txt", header= TRUE, row.names= 1)
rawdata<- rawdata[c(16:30)]
rawdata<-rawdata[,order(names(rawdata))]
y <- DGEList(counts=rawdata[,1:15], genes=rownames(rawdata))
library(lumi)
library(edgeR)
library(lumi)
source("https://bioconductor.org/biocLite.R")
biocLite("lumi")
biocLite("edgeR")
library(lumi)
library(edgeR)
y <- DGEList(counts=rawdata[,1:15], genes=rownames(rawdata))
y <- y[keep,]
keep <- rowSums(cpm(y)>10) >=2
y <- y[keep,]
keep <- rowSums(rawdata>10) >=2
y <- y[keep,]
rawdata<- read.delim("miRNA_raw_counts_CORRECT_NAMES.txt", header= TRUE, row.names= 1)
rawdata<- rawdata[c(16:30)]
rawdata<-rawdata[,order(names(rawdata))]
keep <- rowSums(rawdata>10) >=2
y <- y[keep,]
y <- rawdata[keep,]
View(y)
write.table(y, "HEKexoFiltered.txt", sep="\t")
rawdata<- read.delim("miRNA_raw_counts_CORRECT_NAMES.txt", header= TRUE, row.names= 1)
rawdata<- rawdata[c(42:54)]
rawdata<- rawdata[c(43:54)]
rawdata<- read.delim("miRNA_raw_counts_CORRECT_NAMES.txt", header= TRUE, row.names= 1)
rawdata<- rawdata[c(43:54)]
rawdata<-rawdata[,order(names(rawdata))]
keep <- rowSums(rawdata>10) >=2
y <- rawdata[keep,]
write.table(y, "PC3exoFiltered.txt", sep="\t")
Cav1PN4= rawdata[c(1:3, 10:12)]
View(Cav1PN4)
Cav2PN4= rawdata[c(4:6, 10:12)]
Cav3PN4= rawdata[c(7:9, 10:12)]
exp_designCav = data.frame(row.names = colnames(Cav1PN4),
condition =c("Test", "Test", "Test", "Cont", "Cont", "Cont"),
libType = c("paired-end", "paired-end", "paired-end", "paired-end", "paired-end", "paired-end"))
condition= relevel(exp_designCav$condition, "Test")
levels(exp_designCav)
head(exp_designCav)
ddsCav=DESeqDataSetFromMatrix(countData=Cav1PN4, colData=exp_designCav1, design=~condition)
ddsCav=DESeq(ddsCav)
resCav= results(ddsCav, alpha=0.05)
library(DESeq2)
biocLite("DESeq2")
library(DESeq2)
exp_designCav = data.frame(row.names = colnames(Cav1PN4),
condition =c("Test", "Test", "Test", "Cont", "Cont", "Cont"),
libType = c("paired-end", "paired-end", "paired-end", "paired-end", "paired-end", "paired-end"))
condition= relevel(exp_designCav$condition, "Test")
levels(exp_designCav)
head(exp_designCav)
ddsCav=DESeqDataSetFromMatrix(countData=Cav1PN4, colData=exp_designCav1, design=~condition)
ddsCav=DESeq(ddsCav)
resCav= results(ddsCav, alpha=0.05)
ddsCav=DESeqDataSetFromMatrix(countData=Cav1PN4, colData=exp_designCav, design=~condition)
ddsCav=DESeq(ddsCav)
resCav= results(ddsCav, alpha=0.05)
write.csv(resCav, "Pc3EXOCavin1.csv")
View(Cav1PN4)
Cav1PN4= y[c(1:3, 10:12)]
View(Cav1PN4)
exp_designCav = data.frame(row.names = colnames(Cav1PN4),
condition =c("Test", "Test", "Test", "Cont", "Cont", "Cont"),
libType = c("paired-end", "paired-end", "paired-end", "paired-end", "paired-end", "paired-end"))
condition= relevel(exp_designCav$condition, "Test")
levels(exp_designCav)
head(exp_designCav)
ddsCav=DESeqDataSetFromMatrix(countData=Cav1PN4, colData=exp_designCav, design=~condition)
ddsCav=DESeq(ddsCav)
resCav= results(ddsCav, alpha=0.05)
write.csv(resCav, "Pc3EXOCavin1.csv")
rlogoddsdds=rlogTransformation(ddsCav)
png("plotPCA_rlogoddsNAME.png")
plotPCA(rlogoddsdds)
dev.off()
png("plotPCA_PC3Cav1.png")
plotPCA(rlogoddsdds)
dev.off()
png("plotMA_Cav1PC3_minpval.png")
DESeq2::plotMA(resCav, ylim=c(-3, 3))
topGene<- rownames(resCav)[which.min(resCav$pvalue)]
with(resCav[topGene, ], {
points(baseMean, log2FoldChange, col="dodgerblue", cex=2, lwd=2)
text(baseMean, log2FoldChange, topGene, pos=2, col="dodgerblue")
})
dev.off()
?which.min
topGene<- rownames(resCav)[which.min(resCav$pvalue, 20)]
topGene<- rownames(resCav)[head(resCav[order(resCav$pvalue)])]
topGene<- rownames(resCav)[head(resCav[order(resCav$pvalue)]), ]
low<- resCav(order(resCav$pvalue))
low<- resCav[order(resCav$pvalue), ]
head(low)
topGene<- which(low<= 0.05)
topGene<- which(low$pvalue <=0.05)
topGene
topGene<- rownames(resCav)[which(low$pvalue <=0.05), ]
topGene<- rownames(resCav)[which(low$pvalue <=0.05)]
png("plotMA_Cav1PC3_minpval.png")
DESeq2::plotMA(resCav, ylim=c(-3, 3))
low<- resCav[order(resCav$pvalue), ]
topGene<- rownames(resCav)[which(low$pvalue <=0.05)]
with(resCav[topGene, ], {
points(baseMean, log2FoldChange, col="dodgerblue", cex=2, lwd=2)
text(baseMean, log2FoldChange, topGene, pos=2, col="dodgerblue")
})
dev.off()
png("plotMA_Cav1PC3_minpval.png")
DESeq2::plotMA(resCav, ylim=c(-3, 3))
low<- resCav[order(resCav$pvalue), ]
topGene<- rownames(resCav)[which(low$pvalue <=0.05)]
with(resCav[topGene, ], {
points(baseMean, log2FoldChange, col="dodgerblue", cex=2, lwd=2)
#text(baseMean, log2FoldChange, topGene, pos=2, col="dodgerblue")
})
dev.off()
png("plotMA_Cav1PC3_minpval.png")
DESeq2::plotMA(resCav, ylim=c(-3, 3))
low<- resCav[order(resCav$pvalue), ]
topGene<- rownames(resCav)[which(low$pvalue <=0.05)]
with(resCav[topGene, ], {
points(baseMean, log2FoldChange, col="dodgerblue", cex=2, lwd=2)
text(baseMean, log2FoldChange, topGene, pos=2, col="dodgerblue")
})
dev.off()
Cav2PN4= y[c(4:6, 10:12)]
Cav1PN4= y[c(1:3, 10:12)]
#CaveolinPN4= rawdata[c(3, 8, 13, 1, 5, 14)]
Cav3PN4= y[c(7:9, 10:12)]
exp_designCav = data.frame(row.names = colnames(Cav2PN4),
condition =c("Test", "Test", "Test", "Cont", "Cont", "Cont"),
libType = c("paired-end", "paired-end", "paired-end", "paired-end", "paired-end", "paired-end"))
condition= relevel(exp_designCav$condition, "Test")
levels(exp_designCav)
head(exp_designCav)
ddsCav=DESeqDataSetFromMatrix(countData=Cav1PN4, colData=exp_designCav, design=~condition)
ddsCav=DESeq(ddsCav)
resCav= results(ddsCav, alpha=0.05)
write.csv(resCav, "Pc3EXOCavin2.csv")
rlogoddsdds=rlogTransformation(ddsCav)
png("plotPCA_PC3Cav2.png")
plotPCA(rlogoddsdds)
dev.off()
ddsCav=DESeq(ddsCav)
rlogoddsdds=rlogTransformation(ddsCav)
png("plotPCA_PC3Cav2.png")
plotPCA(rlogoddsdds)
dev.off()
exp_designCav = data.frame(row.names = colnames(Cav2PN4),
condition =c("Test", "Test", "Test", "Cont", "Cont", "Cont"),
libType = c("paired-end", "paired-end", "paired-end", "paired-end", "paired-end", "paired-end"))
condition= relevel(exp_designCav$condition, "Test")
levels(exp_designCav)
head(exp_designCav)
ddsCav=DESeqDataSetFromMatrix(countData=Cav2PN4, colData=exp_designCav, design=~condition)
ddsCav=DESeq(ddsCav)
resCav= results(ddsCav, alpha=0.05)
write.csv(resCav, "Pc3EXOCavin2.csv")
exp_designCav = data.frame(row.names = colnames(Cav2PN4),
condition =c("Test", "Test", "Test", "Cont", "Cont", "Cont"),
libType = c("paired-end", "paired-end", "paired-end", "paired-end", "paired-end", "paired-end"))
condition= relevel(exp_designCav$condition, "Test")
levels(exp_designCav)
head(exp_designCav)
ddsCav=DESeqDataSetFromMatrix(countData=Cav2PN4, colData=exp_designCav, design=~condition)
ddsCav=DESeq(ddsCav)
resCav= results(ddsCav, alpha=0.05)
write.csv(resCav, "Pc3EXOCavin2.csv")
rlogoddsdds=rlogTransformation(ddsCav)
png("plotPCA_PC3Cav2.png")
plotPCA(rlogoddsdds)
dev.off()
png("plotMA_Cav2PC3_minpval.png")
DESeq2::plotMA(resCav, ylim=c(-3, 3))
low<- resCav[order(resCav$pvalue), ]
topGene<- rownames(resCav)[which(low$pvalue <=0.05)]
with(resCav[topGene, ], {
points(baseMean, log2FoldChange, col="dodgerblue", cex=2, lwd=2)
text(baseMean, log2FoldChange, topGene, pos=2, col="dodgerblue")
})
dev.off()
Cav3PN4= y[c(7:9, 10:12)]
exp_designCav = data.frame(row.names = colnames(Cav3PN4),
condition =c("Test", "Test", "Test", "Cont", "Cont", "Cont"),
libType = c("paired-end", "paired-end", "paired-end", "paired-end", "paired-end", "paired-end"))
condition= relevel(exp_designCav$condition, "Test")
levels(exp_designCav)
head(exp_designCav)
ddsCav=DESeqDataSetFromMatrix(countData=Cav3PN4, colData=exp_designCav, design=~condition)
ddsCav=DESeq(ddsCav)
resCav= results(ddsCav, alpha=0.05)
write.csv(resCav, "Pc3EXOCavin3.csv")
rlogoddsdds=rlogTransformation(ddsCav)
png("plotPCA_PC3Cav3.png")
plotPCA(rlogoddsdds)
dev.off()
png("plotMA_Cav3PC3_minpval.png")
DESeq2::plotMA(resCav, ylim=c(-3, 3))
low<- resCav[order(resCav$pvalue), ]
topGene<- rownames(resCav)[which(low$pvalue <=0.05)]
with(resCav[topGene, ], {
points(baseMean, log2FoldChange, col="dodgerblue", cex=2, lwd=2)
text(baseMean, log2FoldChange, topGene, pos=2, col="dodgerblue")
})
dev.off()
Cav1PN4= y[c(1:2, 10:12)]
exp_designCav = data.frame(row.names = colnames(Cav3PN4),
condition =c("Test", "Test", "Cont", "Cont", "Cont"),
libType = c("paired-end", "paired-end", "paired-end", "paired-end", "paired-end"))
condition= relevel(exp_designCav$condition, "Test")
levels(exp_designCav)
head(exp_designCav)
ddsCav=DESeqDataSetFromMatrix(countData=Cav1PN4, colData=exp_designCav, design=~condition)
ddsCav=DESeq(ddsCav)
resCav= results(ddsCav, alpha=0.05)
exp_designCav = data.frame(row.names = colnames(Cav1PN4),
condition =c("Test", "Test", "Cont", "Cont", "Cont"),
libType = c("paired-end", "paired-end", "paired-end", "paired-end", "paired-end"))
condition= relevel(exp_designCav$condition, "Test")
levels(exp_designCav)
head(exp_designCav)
ddsCav=DESeqDataSetFromMatrix(countData=Cav1PN4, colData=exp_designCav, design=~condition)
ddsCav=DESeq(ddsCav)
resCav= results(ddsCav, alpha=0.05)
write.csv(resCav, "Pc3EXOCavin1Removedthirdrep.csv")
View(y)
rlogoddsdds=rlogTransformation(ddsCav)
plotPCA(rlogoddsdds)
colSums(y$PC3_Exosome_CAV1_23.3)
colSums(y$PC3_Exosome_CAV1_23.3, )
colSums(,y$PC3_Exosome_CAV1_23.3)
colSums(y$PC3_Exosome_CAV1_23.3, )
?colSums
colSums(y$PC3_Exosome_CAV1_23.3, na.rm=TRUE)
colSums(y)
rawdata<- read.delim(file="HEKexoFiltered.txt", header= TRUE, row.names=1)
Cav2PN4= rawdata[c(13:15, 4:6)]
Cav1PN4= rawdata[c(10:12, 4:6)]
CaveolinPN4= rawdata[c(1:3, 4:6)]
Cav3PN4= rawdata[c(7:9, 4:6)]
View(Cav1PN4)
exp_designCav = data.frame(row.names = colnames(Cav1PN4),
condition =c("Test", "Test", "Test", "Cont", "Cont", "Cont"),
libType = c("paired-end", "paired-end", "paired-end", "paired-end", "paired-end", "paired-end"))
condition= relevel(exp_designCav$condition, "Test")
levels(exp_designCav)
head(exp_designCav)
ddsCav=DESeqDataSetFromMatrix(countData=Cav1PN4, colData=exp_designCav, design=~condition)
ddsCav=DESeq(ddsCav)
resCav= results(ddsCav, alpha=0.05)
write.csv(resCav, "HEKEXOCavin1.csv")
rlogoddsdds=rlogTransformation(ddsCav)
png("plotPCA_HEKCav1.png")
plotPCA(rlogoddsdds)
dev.off()
png("plotMA_Cav1HEK_minpval.png")
DESeq2::plotMA(resCav, ylim=c(-3, 3))
low<- resCav[order(resCav$pvalue), ]
topGene<- rownames(resCav)[which(low$pvalue <=0.05)]
with(resCav[topGene, ], {
points(baseMean, log2FoldChange, col="dodgerblue", cex=2, lwd=2)
text(baseMean, log2FoldChange, topGene, pos=2, col="dodgerblue")
})
dev.off()
exp_designCav = data.frame(row.names = colnames(Cav2PN4),
condition =c("Test", "Test", "Test", "Cont", "Cont", "Cont"),
libType = c("paired-end", "paired-end", "paired-end", "paired-end", "paired-end", "paired-end"))
condition= relevel(exp_designCav$condition, "Test")
levels(exp_designCav)
head(exp_designCav)
ddsCav=DESeqDataSetFromMatrix(countData=Cav2PN4, colData=exp_designCav, design=~condition)
ddsCav=DESeq(ddsCav)
resCav= results(ddsCav, alpha=0.05)
write.csv(resCav, "HEKEXOCavin2.csv")
rlogoddsdds=rlogTransformation(ddsCav)
png("plotPCA_HEKCav2.png")
plotPCA(rlogoddsdds)
dev.off()
png("plotMA_Cav2HEK_minpval.png")
DESeq2::plotMA(resCav, ylim=c(-3, 3))
low<- resCav[order(resCav$pvalue), ]
topGene<- rownames(resCav)[which(low$pvalue <=0.05)]
with(resCav[topGene, ], {
points(baseMean, log2FoldChange, col="dodgerblue", cex=2, lwd=2)
text(baseMean, log2FoldChange, topGene, pos=2, col="dodgerblue")
})
dev.off()
exp_designCav = data.frame(row.names = colnames(Cav3PN4),
condition =c("Test", "Test", "Test", "Cont", "Cont", "Cont"),
libType = c("paired-end", "paired-end", "paired-end", "paired-end", "paired-end", "paired-end"))
condition= relevel(exp_designCav$condition, "Test")
levels(exp_designCav)
head(exp_designCav)
ddsCav=DESeqDataSetFromMatrix(countData=Cav3PN4, colData=exp_designCav, design=~condition)
ddsCav=DESeq(ddsCav)
resCav= results(ddsCav, alpha=0.05)
write.csv(resCav, "HEKEXOCavin3.csv")
rlogoddsdds=rlogTransformation(ddsCav)
png("plotPCA_HEKCav3.png")
plotPCA(rlogoddsdds)
dev.off()
png("plotMA_Cav3HEK_minpval.png")
DESeq2::plotMA(resCav, ylim=c(-3, 3))
low<- resCav[order(resCav$pvalue), ]
topGene<- rownames(resCav)[which(low$pvalue <=0.05)]
with(resCav[topGene, ], {
points(baseMean, log2FoldChange, col="dodgerblue", cex=2, lwd=2)
text(baseMean, log2FoldChange, topGene, pos=2, col="dodgerblue")
})
dev.off()
exp_designCav = data.frame(row.names = colnames(CaveolinPN4),
condition =c("Test", "Test", "Test", "Cont", "Cont", "Cont"),
libType = c("paired-end", "paired-end", "paired-end", "paired-end", "paired-end", "paired-end"))
condition= relevel(exp_designCav$condition, "Test")
levels(exp_designCav)
head(exp_designCav)
ddsCav=DESeqDataSetFromMatrix(countData=CaveolinPN4, colData=exp_designCav, design=~condition)
ddsCav=DESeq(ddsCav)
resCav= results(ddsCav, alpha=0.05)
write.csv(resCav, "HEKEXOCaveolin.csv")
Cav2PN4= rawdata[c(13:15, 1:3)]
Cav1PN4= rawdata[c(10:12, 1:3)]
CaveolinPN4= rawdata[c(1:3, 4:6)]
Cav3PN4= rawdata[c(7:9, 1:3)]
exp_designCav = data.frame(row.names = colnames(Cav1PN4),
condition =c("Test", "Test", "Test", "Cont", "Cont", "Cont"),
libType = c("paired-end", "paired-end", "paired-end", "paired-end", "paired-end", "paired-end"))
condition= relevel(exp_designCav$condition, "Test")
levels(exp_designCav)
head(exp_designCav)
ddsCav=DESeqDataSetFromMatrix(countData=Cav1PN4, colData=exp_designCav, design=~condition)
ddsCav=DESeq(ddsCav)
resCav= results(ddsCav, alpha=0.05)
write.csv(resCav, "HEKEXOCaveVCav1.csv")
rlogoddsdds=rlogTransformation(ddsCav)
png("plotPCA_HEKCaveVCav1.png")
plotPCA(rlogoddsdds)
dev.off()
png("plotMA_CaveVcav1HEK_minpval.png")
DESeq2::plotMA(resCav, ylim=c(-3, 3))
low<- resCav[order(resCav$pvalue), ]
topGene<- rownames(resCav)[which(low$pvalue <=0.05)]
with(resCav[topGene, ], {
points(baseMean, log2FoldChange, col="dodgerblue", cex=2, lwd=2)
text(baseMean, log2FoldChange, topGene, pos=2, col="dodgerblue")
})
dev.off()
exp_designCav = data.frame(row.names = colnames(Cav2PN4),
condition =c("Test", "Test", "Test", "Cont", "Cont", "Cont"),
libType = c("paired-end", "paired-end", "paired-end", "paired-end", "paired-end", "paired-end"))
condition= relevel(exp_designCav$condition, "Test")
levels(exp_designCav)
head(exp_designCav)
ddsCav=DESeqDataSetFromMatrix(countData=Cav2PN4, colData=exp_designCav, design=~condition)
ddsCav=DESeq(ddsCav)
resCav= results(ddsCav, alpha=0.05)
write.csv(resCav, "HEKEXOCaveVCav2.csv")
rlogoddsdds=rlogTransformation(ddsCav)
png("plotPCA_HEKCaveVCav2.png")
plotPCA(rlogoddsdds)
dev.off()
png("plotMA_CaveVcav2HEK_minpval.png")
DESeq2::plotMA(resCav, ylim=c(-3, 3))
low<- resCav[order(resCav$pvalue), ]
topGene<- rownames(resCav)[which(low$pvalue <=0.05)]
with(resCav[topGene, ], {
points(baseMean, log2FoldChange, col="dodgerblue", cex=2, lwd=2)
text(baseMean, log2FoldChange, topGene, pos=2, col="dodgerblue")
})
dev.off()
exp_designCav = data.frame(row.names = colnames(Cav3PN4),
condition =c("Test", "Test", "Test", "Cont", "Cont", "Cont"),
libType = c("paired-end", "paired-end", "paired-end", "paired-end", "paired-end", "paired-end"))
condition= relevel(exp_designCav$condition, "Test")
levels(exp_designCav)
head(exp_designCav)
ddsCav=DESeqDataSetFromMatrix(countData=Cav3PN4, colData=exp_designCav, design=~condition)
ddsCav=DESeq(ddsCav)
resCav= results(ddsCav, alpha=0.05)
write.csv(resCav, "HEKEXOCaveVCav3.csv")
rlogoddsdds=rlogTransformation(ddsCav)
png("plotPCA_HEKCaveVCav3.png")
plotPCA(rlogoddsdds)
dev.off()
png("plotMA_CaveVcav3HEK_minpval.png")
DESeq2::plotMA(resCav, ylim=c(-3, 3))
low<- resCav[order(resCav$pvalue), ]
topGene<- rownames(resCav)[which(low$pvalue <=0.05)]
with(resCav[topGene, ], {
points(baseMean, log2FoldChange, col="dodgerblue", cex=2, lwd=2)
text(baseMean, log2FoldChange, topGene, pos=2, col="dodgerblue")
})
dev.off()
rawdata<- read.delim(file="PC3exoFiltered.txt", header= TRUE, row.names=1)
View(rawdata)
Cav1PN4= rawdata[c(1:2, 10:11)]
exp_designCav = data.frame(row.names = colnames(Cav1PN4),
condition =c("Test", "Test", "Test", "Cont", "Cont", "Cont"),
libType = c("paired-end", "paired-end", "paired-end", "paired-end", "paired-end", "paired-end"))
condition= relevel(exp_designCav$condition, "Test")
levels(exp_designCav)
head(exp_designCav)
ddsCav=DESeqDataSetFromMatrix(countData=Cav1PN4, colData=exp_designCav, design=~condition)
ddsCav=DESeq(ddsCav)
resCav= results(ddsCav, alpha=0.05)
library(DESeq2)
exp_designCav = data.frame(row.names = colnames(Cav1PN4),
condition =c("Test", "Test", "Test", "Cont", "Cont", "Cont"),
libType = c("paired-end", "paired-end", "paired-end", "paired-end", "paired-end", "paired-end"))
condition= relevel(exp_designCav$condition, "Test")
levels(exp_designCav)
head(exp_designCav)
ddsCav=DESeqDataSetFromMatrix(countData=Cav1PN4, colData=exp_designCav, design=~condition)
ddsCav=DESeq(ddsCav)
resCav= results(ddsCav, alpha=0.05)
exp_designCav = data.frame(row.names = colnames(Cav1PN4),
condition =c("Test", "Test", "Cont", "Cont"),
libType = c("paired-end", "paired-end", "paired-end", "paired-end", "paired-end", "paired-end"))
condition= relevel(exp_designCav$condition, "Test")
levels(exp_designCav)
head(exp_designCav)
ddsCav=DESeqDataSetFromMatrix(countData=Cav1PN4, colData=exp_designCav, design=~condition)
ddsCav=DESeq(ddsCav)
resCav= results(ddsCav, alpha=0.05)
exp_designCav = data.frame(row.names = colnames(Cav1PN4),
condition =c("Test", "Test", "Cont", "Cont"),
libType = c("paired-end", "paired-end", "paired-end", "paired-end"))
condition= relevel(exp_designCav$condition, "Test")
levels(exp_designCav)
head(exp_designCav)
ddsCav=DESeqDataSetFromMatrix(countData=Cav1PN4, colData=exp_designCav, design=~condition)
ddsCav=DESeq(ddsCav)
resCav= results(ddsCav, alpha=0.05)
write.csv(resCav, "PC3Cav1REmovedoutliers.csv")
colSums(rawdata)
mean(colsums(rawdata[, 7:9]))
mean(rawdata[, 7:9])
1339663+800528+433291
(1339663+800528+433291)/3
?"DESeq"
